{% doc %}
  @prompt
    Create a "Buy on Amazon" button that appears below the Add to Cart button on product pages. The button should have Amazon's orange color (#FF9900), open the Amazon search for the product in a new tab, and match the styling of the existing buy buttons with proper spacing.
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-amazon-button-{{ ai_gen_id }} {
    display: block;
    width: 100%;
    margin-top: {{ block.settings.spacing_top }}px;
  }

  .ai-amazon-button__link-{{ ai_gen_id }} {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    padding: 15px 30px;
    background-color: {{ block.settings.button_color }};
    color: {{ block.settings.text_color }};
    text-decoration: none;
    border-radius: {{ block.settings.border_radius }}px;
    font-family: {{ block.settings.button_font.family }}, {{ block.settings.button_font.fallback_families }};
    font-weight: {{ block.settings.button_font.weight }};
    font-size: {{ block.settings.font_size }}px;
    text-transform: {{ block.settings.text_transform }};
    transition: background-color 0.3s ease, transform 0.2s ease;
    cursor: pointer;
    border: none;
    gap: 10px;
  }

  .ai-amazon-button__link-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.button_hover_color }};
    transform: translateY(-1px);
  }

  .ai-amazon-button__link-{{ ai_gen_id }}:active {
    transform: translateY(0);
  }

  .ai-amazon-button__icon-{{ ai_gen_id }} {
    width: {{ block.settings.icon_size }}px;
    height: {{ block.settings.icon_size }}px;
    fill: currentColor;
  }

  @media screen and (max-width: 749px) {
    .ai-amazon-button__link-{{ ai_gen_id }} {
      padding: 12px 24px;
      font-size: {{ block.settings.font_size | times: 0.9 }}px;
    }
  }
{% endstyle %}

<div class="ai-amazon-button-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <a
    href="https://www.amazon.com/s?k={{ product.title | url_encode }}"
    class="ai-amazon-button__link-{{ ai_gen_id }}"
    target="_blank"
    rel="noopener noreferrer"
    aria-label="Buy {{ product.title }} on Amazon"
  >
    {% if block.settings.show_icon %}
      <svg class="ai-amazon-button__icon-{{ ai_gen_id }}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
        <path d="M.045 18.02c.072-.116.187-.124.348-.022 3.636 2.11 7.594 3.166 11.87 3.166 2.852 0 5.668-.533 8.447-1.595l.315-.14c.138-.06.234-.1.293-.13.226-.088.39-.046.525.13.12.174.09.336-.12.48-.256.19-.6.41-1.006.654-1.244.743-2.64 1.316-4.185 1.726-1.53.406-3.045.61-4.516.61-2.265 0-4.463-.42-6.588-1.265-2.11-.84-3.937-1.99-5.478-3.445-.135-.117-.18-.235-.135-.352zm23.71.295c-.225-.27-.494-.32-.77-.2-.258.1-.48.18-.68.24-.19.06-.43.12-.71.19-.285.07-.525.11-.725.13l-.3.04c-.376.05-.706.03-1.005-.06-.3-.094-.554-.25-.764-.465-.21-.215-.314-.43-.314-.645 0-.44.216-.81.65-1.11.434-.3 1.03-.53 1.79-.69.76-.16 1.53-.24 2.304-.24.45 0 .945.08 1.486.24v-.69c0-.69-.12-1.19-.36-1.5-.24-.31-.67-.465-1.29-.465-.465 0-.87.105-1.214.315-.345.21-.614.54-.81.99-.075.165-.195.255-.36.27l-1.65-.18c-.195-.045-.3-.15-.315-.315.045-.705.3-1.335.765-1.89.465-.555 1.08-.975 1.845-1.26.765-.285 1.56-.43 2.385-.43 1.395 0 2.43.33 3.105.99.675.66 1.014 1.635 1.014 2.925v3.87c0 .705.135 1.29.405 1.755.27.465.54.795.81 1.005.12.09.165.195.135.315-.03.12-.105.21-.225.27-.705.57-1.29 1.05-1.755 1.44l-.06-.045c-.27-.285-.495-.6-.675-.945-.18-.345-.345-.735-.495-1.17l-.045.03zm-1.8-5.685c-.015.705-.03 1.17-.045 1.395-.015.225-.015.375 0 .45v.105c-.705-.135-1.38-.12-2.025.045-.645.165-1.035.42-1.17.765-.045.12-.075.27-.075.45 0 .27.105.495.315.675.21.18.48.27.81.27.705 0 1.29-.3 1.755-.9.465-.6.705-1.35.72-2.25l-.285-.005z"/>
      </svg>
    {% endif %}
    {{ block.settings.button_text }}
  </a>
</div>

{% schema %}
{
  "name": "Buy on Amazon button",
  "settings": [
    {
      "type": "header",
      "content": "Button"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Buy on Amazon"
    },
    {
      "type": "checkbox",
      "id": "show_icon",
      "label": "Show Amazon icon",
      "default": true
    },
    {
      "type": "range",
      "id": "icon_size",
      "label": "Icon size",
      "min": 16,
      "max": 32,
      "step": 2,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "font_size",
      "label": "Font size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "font_picker",
      "id": "button_font",
      "label": "Font",
      "default": "helvetica_n4"
    },
    {
      "type": "select",
      "id": "text_transform",
      "label": "Text style",
      "options": [
        {
          "value": "none",
          "label": "Normal"
        },
        {
          "value": "uppercase",
          "label": "Uppercase"
        },
        {
          "value": "capitalize",
          "label": "Capitalize"
        }
      ],
      "default": "none"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "button_color",
      "label": "Background color",
      "default": "#FF9900"
    },
    {
      "type": "color",
      "id": "button_hover_color",
      "label": "Hover background color",
      "default": "#E68A00"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#000000"
    },
    {
      "type": "header",
      "content": "Style"
    },
    {
      "type": "range",
      "id": "border_radius",
      "label": "Border radius",
      "min": 0,
      "max": 50,
      "step": 2,
      "unit": "px",
      "default": 4
    },
    {
      "type": "range",
      "id": "spacing_top",
      "label": "Spacing above button",
      "min": 0,
      "max": 50,
      "step": 2,
      "unit": "px",
      "default": 12
    }
  ],
  "presets": [
    {
      "name": "Buy on Amazon button"
    }
  ]
}
{% endschema %}
